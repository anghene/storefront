{"remainingRequest":"/Users/vaa/code/ful/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/vaa/code/ful/src/components/Checkout.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/vaa/code/ful/src/components/Checkout.vue","mtime":1727886668000},{"path":"/Users/vaa/code/ful/node_modules/cache-loader/dist/cjs.js","mtime":1727895832636},{"path":"/Users/vaa/code/ful/node_modules/babel-loader/lib/index.js","mtime":1727895832920},{"path":"/Users/vaa/code/ful/node_modules/cache-loader/dist/cjs.js","mtime":1727895832636},{"path":"/Users/vaa/code/ful/node_modules/vue-loader/lib/index.js","mtime":1727895832988}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ2hlY2tvdXQnLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzdHJpcGU6IG51bGwsIC8vIFN0cmlwZSBpbnN0YW5jZQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKFsnY2FydEl0ZW1zJywgJ2NhcnRUb3RhbCddKSwKICAgIGNhcnQoKSB7CiAgICAgIHJldHVybiB0aGlzLmNhcnRJdGVtczsKICAgIH0sCiAgICB0b3RhbFByaWNlKCkgewogICAgICByZXR1cm4gdGhpcy5jYXJ0VG90YWw7CiAgICB9LAogIH0sCiAgbW91bnRlZCgpIHsKICAgIGNvbnNvbGUubG9nKCJMb2FkaW5nIFN0cmlwZSBzY3JpcHQgZHluYW1pY2FsbHkuLi4iKTsKCiAgICAvLyBEeW5hbWljYWxseSBsb2FkIHRoZSBTdHJpcGUgc2NyaXB0IGFuZCBpbml0aWFsaXplIFN0cmlwZSBvbmx5IHdoZW4gcmVhZHkKICAgIHRoaXMubG9hZFN0cmlwZVNjcmlwdCgpCiAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICBjb25zb2xlLmxvZygiU3RyaXBlIHNjcmlwdCBzdWNjZXNzZnVsbHkgbG9hZGVkISIpOwogICAgICAgIHRoaXMuc3RyaXBlID0gd2luZG93LlN0cmlwZShwcm9jZXNzLmVudi5WVUVfQVBQX1NUUklQRV9QVUJMSVNIQUJMRV9LRVkpOwogICAgICAgIGlmICh0aGlzLnN0cmlwZSkgewogICAgICAgICAgY29uc29sZS5sb2coIlN0cmlwZSBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHkgd2l0aCB0aGUgZW52aXJvbm1lbnQga2V5OiIsIHRoaXMuc3RyaXBlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5lcnJvcigiU3RyaXBlIGluaXRpYWxpemF0aW9uIGZhaWxlZC4gQ2hlY2sgdGhlIGVudmlyb25tZW50IHZhcmlhYmxlLiIpOwogICAgICAgICAgYWxlcnQoIlVuYWJsZSB0byBpbml0aWFsaXplIFN0cmlwZS4gUGxlYXNlIGNoZWNrIHlvdXIgY29uZmlndXJhdGlvbi4iKTsKICAgICAgICB9CiAgICAgIH0pCiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBsb2FkaW5nIFN0cmlwZSBzY3JpcHQ6IiwgZXJyb3IpOwogICAgICAgIGFsZXJ0KCJVbmFibGUgdG8gbG9hZCBTdHJpcGUuIFBsZWFzZSBjaGVjayB5b3VyIGNvbm5lY3Rpb24gb3IgdHJ5IGFnYWluIGxhdGVyLiIpOwogICAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGxvYWRTdHJpcGVTY3JpcHQoKSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgaWYgKHdpbmRvdy5TdHJpcGUpIHsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICAgICAgICBzY3JpcHQuc3JjID0gJ2h0dHBzOi8vanMuc3RyaXBlLmNvbS92My8nOwogICAgICAgICAgc2NyaXB0Lm9ubG9hZCA9ICgpID0+IHJlc29sdmUoKTsKICAgICAgICAgIHNjcmlwdC5vbmVycm9yID0gKCkgPT4gcmVqZWN0KG5ldyBFcnJvcigiRmFpbGVkIHRvIGxvYWQgU3RyaXBlLmpzIikpOwogICAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlQ2hlY2tvdXQoKSB7CiAgICAgIGlmICghdGhpcy5zdHJpcGUpIHsKICAgICAgICBhbGVydCgiU3RyaXBlIGlzIG5vdCByZWFkeSB5ZXQuIFBsZWFzZSB0cnkgYWdhaW4gaW4gYSBtb21lbnQuIik7CiAgICAgICAgY29uc29sZS5lcnJvcigiU3RyaXBlIGluc3RhbmNlIGlzIG5vdCBpbml0aWFsaXplZCB5ZXQuIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLmNhcnQubGVuZ3RoID09PSAwKSB7CiAgICAgICAgYWxlcnQoJ1lvdXIgY2FydCBpcyBlbXB0eSEnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnNvbGUubG9nKCdJbml0aWF0aW5nIFN0cmlwZSBDaGVja291dCB3aXRoIENhcnQ6JywgdGhpcy5jYXJ0KTsKCiAgICAgIC8vIFJlcGxhY2UgdGhlc2Ugd2l0aCBhY3R1YWwgUHJpY2UgSURzIGZyb20geW91ciBTdHJpcGUgRGFzaGJvYXJkCiAgICAgIGNvbnN0IHByaWNlTWFwcGluZyA9IHsKICAgICAgICAnU2VhZ2F0ZSBEcml2ZSAxIFRCJzogJ3ByaWNlXzFRNVhJVERMcmtGOXJSdU1TRDFyWGVXTCcsIC8vIFVwZGF0ZWQgVGVzdCBNb2RlIFByaWNlIElEIGZvciBTZWFnYXRlIERyaXZlCiAgICAgICAgJ1JhaW5ib3cgTGFtcCc6ICdwcmljZV9wbGFjZWhvbGRlcl8xJywKICAgICAgICAnVmlicmFudCBUYWJsZSc6ICdwcmljZV9wbGFjZWhvbGRlcl8yJywKICAgICAgICAnQXJ0aXN0aWMgTXVnJzogJ3ByaWNlX3BsYWNlaG9sZGVyXzMnCiAgICAgIH07CgogICAgICAvLyBDcmVhdGUgbGluZSBpdGVtcyB1c2luZyB0aGUgcHJlZGVmaW5lZCBwcmljZSBJRHMKICAgICAgY29uc3QgbGluZUl0ZW1zID0gdGhpcy5jYXJ0Lm1hcCgoaXRlbSkgPT4gKHsKICAgICAgICBwcmljZTogcHJpY2VNYXBwaW5nW2l0ZW0ubmFtZV0sCiAgICAgICAgcXVhbnRpdHk6IDEsCiAgICAgIH0pKTsKCiAgICAgIC8vIFRyaWdnZXIgU3RyaXBlIGNoZWNrb3V0CiAgICAgIHRoaXMuc3RyaXBlLnJlZGlyZWN0VG9DaGVja291dCh7CiAgICAgICAgbGluZUl0ZW1zOiBsaW5lSXRlbXMsCiAgICAgICAgbW9kZTogJ3BheW1lbnQnLAogICAgICAgIHN1Y2Nlc3NVcmw6IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gKyAnL3N1Y2Nlc3MnLAogICAgICAgIGNhbmNlbFVybDogd2luZG93LmxvY2F0aW9uLm9yaWdpbiArICcvY2FuY2VsJywKICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgaWYgKHJlc3VsdC5lcnJvcikgewogICAgICAgICAgY29uc29sZS5lcnJvcignU3RyaXBlIENoZWNrb3V0IEVycm9yOicsIHJlc3VsdC5lcnJvci5tZXNzYWdlKTsKICAgICAgICAgIGFsZXJ0KHJlc3VsdC5lcnJvci5tZXNzYWdlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Checkout.vue"],"names":[],"mappings":";AAkBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Checkout.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"checkout-container\">\n    <h2>Checkout</h2>\n    <div v-if=\"cart.length > 0\">\n      <h3>Items in your cart:</h3>\n      <ul>\n        <li v-for=\"(item, index) in cart\" :key=\"index\">\n          {{ item.name }} - ${{ item.price }}\n        </li>\n      </ul>\n      <p><strong>Total: ${{ totalPrice }}</strong></p>\n      <button class=\"checkout-button\" @click=\"handleCheckout\">Pay with Stripe</button>\n    </div>\n    <p v-else>Your cart is empty.</p>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex';\n\nexport default {\n  name: 'Checkout',\n  data() {\n    return {\n      stripe: null, // Stripe instance\n    };\n  },\n  computed: {\n    ...mapGetters(['cartItems', 'cartTotal']),\n    cart() {\n      return this.cartItems;\n    },\n    totalPrice() {\n      return this.cartTotal;\n    },\n  },\n  mounted() {\n    console.log(\"Loading Stripe script dynamically...\");\n\n    // Dynamically load the Stripe script and initialize Stripe only when ready\n    this.loadStripeScript()\n      .then(() => {\n        console.log(\"Stripe script successfully loaded!\");\n        this.stripe = window.Stripe(process.env.VUE_APP_STRIPE_PUBLISHABLE_KEY);\n        if (this.stripe) {\n          console.log(\"Stripe initialized successfully with the environment key:\", this.stripe);\n        } else {\n          console.error(\"Stripe initialization failed. Check the environment variable.\");\n          alert(\"Unable to initialize Stripe. Please check your configuration.\");\n        }\n      })\n      .catch((error) => {\n        console.error(\"Error loading Stripe script:\", error);\n        alert(\"Unable to load Stripe. Please check your connection or try again later.\");\n      });\n  },\n  methods: {\n    loadStripeScript() {\n      return new Promise((resolve, reject) => {\n        if (window.Stripe) {\n          resolve();\n        } else {\n          const script = document.createElement('script');\n          script.src = 'https://js.stripe.com/v3/';\n          script.onload = () => resolve();\n          script.onerror = () => reject(new Error(\"Failed to load Stripe.js\"));\n          document.head.appendChild(script);\n        }\n      });\n    },\n    handleCheckout() {\n      if (!this.stripe) {\n        alert(\"Stripe is not ready yet. Please try again in a moment.\");\n        console.error(\"Stripe instance is not initialized yet.\");\n        return;\n      }\n      if (this.cart.length === 0) {\n        alert('Your cart is empty!');\n        return;\n      }\n\n      console.log('Initiating Stripe Checkout with Cart:', this.cart);\n\n      // Replace these with actual Price IDs from your Stripe Dashboard\n      const priceMapping = {\n        'Seagate Drive 1 TB': 'price_1Q5XITDLrkF9rRuMSD1rXeWL', // Updated Test Mode Price ID for Seagate Drive\n        'Rainbow Lamp': 'price_placeholder_1',\n        'Vibrant Table': 'price_placeholder_2',\n        'Artistic Mug': 'price_placeholder_3'\n      };\n\n      // Create line items using the predefined price IDs\n      const lineItems = this.cart.map((item) => ({\n        price: priceMapping[item.name],\n        quantity: 1,\n      }));\n\n      // Trigger Stripe checkout\n      this.stripe.redirectToCheckout({\n        lineItems: lineItems,\n        mode: 'payment',\n        successUrl: window.location.origin + '/success',\n        cancelUrl: window.location.origin + '/cancel',\n      }).then((result) => {\n        if (result.error) {\n          console.error('Stripe Checkout Error:', result.error.message);\n          alert(result.error.message);\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.checkout-container {\n  margin: 50px auto;\n  width: 500px;\n  padding: 20px;\n  background: #f7f9f9;\n  border-radius: 8px;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  text-align: center;\n}\n.checkout-button {\n  padding: 10px 20px;\n  background-color: #6772e5;\n  border: none;\n  color: white;\n  cursor: pointer;\n  border-radius: 5px;\n  transition: background-color 0.3s ease;\n}\n.checkout-button:hover {\n  background-color: #5469d4;\n}\n</style>\n"]}]}