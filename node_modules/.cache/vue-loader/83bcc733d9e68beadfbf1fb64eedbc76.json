{"remainingRequest":"/Users/vaa/code/ful/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/vaa/code/ful/src/components/Checkout.vue?vue&type=style&index=0&id=7eff5a76&scoped=true&lang=css","dependencies":[{"path":"/Users/vaa/code/ful/src/components/Checkout.vue","mtime":1727886668000},{"path":"/Users/vaa/code/ful/node_modules/css-loader/dist/cjs.js","mtime":1727895832834},{"path":"/Users/vaa/code/ful/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1727895833150},{"path":"/Users/vaa/code/ful/node_modules/postcss-loader/src/index.js","mtime":1727895832918},{"path":"/Users/vaa/code/ful/node_modules/cache-loader/dist/cjs.js","mtime":1727895832636},{"path":"/Users/vaa/code/ful/node_modules/vue-loader/lib/index.js","mtime":1727895832988}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5jaGVja291dC1jb250YWluZXIgewogIG1hcmdpbjogNTBweCBhdXRvOwogIHdpZHRoOiA1MDBweDsKICBwYWRkaW5nOiAyMHB4OwogIGJhY2tncm91bmQ6ICNmN2Y5Zjk7CiAgYm9yZGVyLXJhZGl1czogOHB4OwogIGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoMCwgMCwgMCwgMC4xKTsKICB0ZXh0LWFsaWduOiBjZW50ZXI7Cn0KLmNoZWNrb3V0LWJ1dHRvbiB7CiAgcGFkZGluZzogMTBweCAyMHB4OwogIGJhY2tncm91bmQtY29sb3I6ICM2NzcyZTU7CiAgYm9yZGVyOiBub25lOwogIGNvbG9yOiB3aGl0ZTsKICBjdXJzb3I6IHBvaW50ZXI7CiAgYm9yZGVyLXJhZGl1czogNXB4OwogIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4zcyBlYXNlOwp9Ci5jaGVja291dC1idXR0b246aG92ZXIgewogIGJhY2tncm91bmQtY29sb3I6ICM1NDY5ZDQ7Cn0K"},{"version":3,"sources":["Checkout.vue"],"names":[],"mappings":";AAmHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Checkout.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"checkout-container\">\n    <h2>Checkout</h2>\n    <div v-if=\"cart.length > 0\">\n      <h3>Items in your cart:</h3>\n      <ul>\n        <li v-for=\"(item, index) in cart\" :key=\"index\">\n          {{ item.name }} - ${{ item.price }}\n        </li>\n      </ul>\n      <p><strong>Total: ${{ totalPrice }}</strong></p>\n      <button class=\"checkout-button\" @click=\"handleCheckout\">Pay with Stripe</button>\n    </div>\n    <p v-else>Your cart is empty.</p>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex';\n\nexport default {\n  name: 'Checkout',\n  data() {\n    return {\n      stripe: null, // Stripe instance\n    };\n  },\n  computed: {\n    ...mapGetters(['cartItems', 'cartTotal']),\n    cart() {\n      return this.cartItems;\n    },\n    totalPrice() {\n      return this.cartTotal;\n    },\n  },\n  mounted() {\n    console.log(\"Loading Stripe script dynamically...\");\n\n    // Dynamically load the Stripe script and initialize Stripe only when ready\n    this.loadStripeScript()\n      .then(() => {\n        console.log(\"Stripe script successfully loaded!\");\n        this.stripe = window.Stripe(process.env.VUE_APP_STRIPE_PUBLISHABLE_KEY);\n        if (this.stripe) {\n          console.log(\"Stripe initialized successfully with the environment key:\", this.stripe);\n        } else {\n          console.error(\"Stripe initialization failed. Check the environment variable.\");\n          alert(\"Unable to initialize Stripe. Please check your configuration.\");\n        }\n      })\n      .catch((error) => {\n        console.error(\"Error loading Stripe script:\", error);\n        alert(\"Unable to load Stripe. Please check your connection or try again later.\");\n      });\n  },\n  methods: {\n    loadStripeScript() {\n      return new Promise((resolve, reject) => {\n        if (window.Stripe) {\n          resolve();\n        } else {\n          const script = document.createElement('script');\n          script.src = 'https://js.stripe.com/v3/';\n          script.onload = () => resolve();\n          script.onerror = () => reject(new Error(\"Failed to load Stripe.js\"));\n          document.head.appendChild(script);\n        }\n      });\n    },\n    handleCheckout() {\n      if (!this.stripe) {\n        alert(\"Stripe is not ready yet. Please try again in a moment.\");\n        console.error(\"Stripe instance is not initialized yet.\");\n        return;\n      }\n      if (this.cart.length === 0) {\n        alert('Your cart is empty!');\n        return;\n      }\n\n      console.log('Initiating Stripe Checkout with Cart:', this.cart);\n\n      // Replace these with actual Price IDs from your Stripe Dashboard\n      const priceMapping = {\n        'Seagate Drive 1 TB': 'price_1Q5XITDLrkF9rRuMSD1rXeWL', // Updated Test Mode Price ID for Seagate Drive\n        'Rainbow Lamp': 'price_placeholder_1',\n        'Vibrant Table': 'price_placeholder_2',\n        'Artistic Mug': 'price_placeholder_3'\n      };\n\n      // Create line items using the predefined price IDs\n      const lineItems = this.cart.map((item) => ({\n        price: priceMapping[item.name],\n        quantity: 1,\n      }));\n\n      // Trigger Stripe checkout\n      this.stripe.redirectToCheckout({\n        lineItems: lineItems,\n        mode: 'payment',\n        successUrl: window.location.origin + '/success',\n        cancelUrl: window.location.origin + '/cancel',\n      }).then((result) => {\n        if (result.error) {\n          console.error('Stripe Checkout Error:', result.error.message);\n          alert(result.error.message);\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.checkout-container {\n  margin: 50px auto;\n  width: 500px;\n  padding: 20px;\n  background: #f7f9f9;\n  border-radius: 8px;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  text-align: center;\n}\n.checkout-button {\n  padding: 10px 20px;\n  background-color: #6772e5;\n  border: none;\n  color: white;\n  cursor: pointer;\n  border-radius: 5px;\n  transition: background-color 0.3s ease;\n}\n.checkout-button:hover {\n  background-color: #5469d4;\n}\n</style>\n"]}]}